plugins {
  id 'java'
  id 'java-test-fixtures'
}

dependencies {
  implementation project(':hoptimator-api')
  implementation project(':hoptimator-jdbc')
  implementation project(':hoptimator-util')
  implementation libs.calcite.server
  implementation libs.kubernetes.client

  // These are included in case the demo databases are deployed.
  testRuntimeOnly project(':hoptimator-demodb')
  testRuntimeOnly project(':hoptimator-kafka')
  testRuntimeOnly project(':hoptimator-venice')

  testImplementation(testFixtures(project(':hoptimator-jdbc')))
	testImplementation(platform('org.junit:junit-bom:5.11.3'))
	testImplementation 'org.junit.jupiter:junit-jupiter'
  testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
  testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine'
}

test {
	useJUnitPlatform {
    excludeTags 'integration'
  }
	testLogging {
		events "passed", "skipped", "failed"
	}
}

tasks.register('intTest', Test) {
  description = 'Runs integration tests.'
  group = 'verification'

  shouldRunAfter test

  useJUnitPlatform {
    includeTags 'integration'
  }

  testLogging {
    events "passed", "skipped", "failed"
  }
}
